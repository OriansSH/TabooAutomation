# Test info

- Name: Purchase Tests >> Taboo > Logged In Customer > Launch Game > Open Store > Purchase a package
- Location: /home/runner/work/TabooAutomation/TabooAutomation/__tests__/purchase/purchaseTests.spec.js:91:5

# Error details

```
Error: Timed out 5000ms waiting for expect(locator).toBeVisible()

Locator: locator('.ple-title:has-text("Payment Confirmed! You\'re all set!")')
Expected: visible
Received: <element(s) not found>
Call log:
  - expect.toBeVisible with timeout 5000ms
  - waiting for locator('.ple-title:has-text("Payment Confirmed! You\'re all set!")')

    at Purchase.verifyConfirmationMessage (/home/runner/work/TabooAutomation/TabooAutomation/__tests__/purchase/PurchasePage.js:95:55)
    at /home/runner/work/TabooAutomation/TabooAutomation/__tests__/purchase/purchaseTests.spec.js:101:24
```

# Page snapshot

```yaml
- dialog:
  - text: Get coins
  - button "test option 1 100k + 157 FREE Coin 0 $1":
    - text: test option 1
    - img
    - text: 100k +
    - img
    - text: 157 FREE
    - img "Coin 0"
    - button "$1"
  - button "test option 2 158k + 200 FREE Coin 1 $1":
    - text: test option 2
    - img
    - text: 158k +
    - img
    - text: 200 FREE
    - img "Coin 1"
    - button "$1"
  - button "150k + 100 FREE Coin 2 $100":
    - img
    - text: 150k +
    - img
    - text: 100 FREE
    - img "Coin 2"
    - button "$100"
  - button "200k + 200 FREE Coin 3 $200":
    - img
    - text: 200k +
    - img
    - text: 200 FREE
    - img "Coin 3"
    - button "$200"
  - button "300k + 300 FREE Coin 4 $300":
    - img
    - text: 300k +
    - img
    - text: 300 FREE
    - img "Coin 4"
    - button "$300"
  - button "500k + 550 FREE Coin 5 $500":
    - img
    - text: 500k +
    - img
    - text: 550 FREE
    - img "Coin 5"
    - button "$500"
  - region "Notifications (F8)":
    - list
  - iframe
  - button "Close":
    - img
    - text: Close
- iframe
- iframe
```

# Test source

```ts
   1 | import { expect } from '@playwright/test';
   2 | import * as utils from '../utils.js';
   3 |
   4 | export class Purchase {
   5 |     constructor(page) {
   6 |         this.page = page;
   7 |         const frame = page.frameLocator('iframe[title="Pay.com\'s universal frame"]');
   8 |         this.purchaseGold = page.locator(utils.purchaseGoldButton);
   9 |         this.purchaseSecret = page.locator(utils.purchaseSecretButton);
   10 |         this.toggleGold = page.locator(utils.toggleGoldButton);
   11 |         this.toggleSecret = page.locator(utils.toggleSecretButton);
   12 |         this.xButton = page.locator(utils.xButton);
   13 |         this.packageLocator = page.locator('div').filter({ hasText: /^500kGOLD COINS\+550Secret Coins\$500$/ }).getByRole('button');
   14 |         this.couponField = page.getByPlaceholder(utils.couponPlaceholder);
   15 |         this.couponButton = page.locator(utils.couponCodeButton)
   16 |         this.oldPrice = page.locator(utils.packageOldPriceClass);
   17 |         this.checkoutPurchaseButton = page.locator(utils.checkoutPurchaseButton);
   18 |         this.generalErrorLocator = page.locator(utils.generalErrorLocator);
   19 |         this.buyIconLocator = page.locator(utils.buyIcon);
   20 |         this.cardNumberField = frame.locator(utils.cardNumberLocator);
   21 |         this.cardExpiryField = frame.locator(utils.cardExpiryLocator);
   22 |         this.cardCvvField = frame.locator(utils.cardCvvLocator);
   23 |         this.cardNameField = frame.locator(utils.cardNameLocator);
   24 |         this.cardPayButtonLocator = frame.locator(utils.cardPayButtonLocator);
   25 |         this.confirmationMessageLocator = page.locator(utils.confirmationMessageLocator);
   26 |         this.cardNumberError = frame.locator(utils.cardNumberErrorLocator);
   27 |         this.cardExpiryError = frame.locator(utils.cardExpiryErrorLocator);
   28 |         this.cardCvvError = frame.locator(utils.cardCvvErrorLocator);
   29 |         this.cardNameError = frame.locator(utils.cardNameErrorLocator);
   30 |         this.inGameStore = page.locator(utils.inGameStoreLocator);
   31 |
   32 |     }
   33 |
   34 |
   35 |     async clickOnPurchaseGoldButton() {
   36 |         await this.purchaseGold.click();
   37 |     }
   38 |     async clickOnPurchaseSecretButton() {
   39 |         await this.purchaseSecret.click();
   40 |     }
   41 |     async toggleGoldButton() {
   42 |         await this.toggleGold.click();
   43 |     }
   44 |     async toggleSecretButton() {
   45 |         await this.toggleSecret.click();
   46 |     }
   47 |     async clickOnXButton() {
   48 |         await this.xButton.click();
   49 |     }
   50 |     async selectPackage() {
   51 |         await this.packageLocator.click();
   52 |     }
   53 |     async fillCouponCode(couponCode) {
   54 |         await this.couponField.fill(couponCode);
   55 |     }
   56 |     async clickOnCouponButton() {
   57 |         await this.couponButton.click();
   58 |         return this.couponButton;
   59 |     }
   60 |     async verifyOldPriceVisible() {
   61 |         await expect(this.oldPrice).toBeVisible();
   62 |     }
   63 |     async clickOnCheckoutPurchaseButton() {
   64 |         await this.checkoutPurchaseButton.click();
   65 |         return this.checkoutPurchaseButton;
   66 |     }
   67 |     async verifyGeneralErrorVisible() {
   68 |         await expect(this.generalErrorLocator).toHaveText(utils.couponEmptyGeneraError);
   69 |     }
   70 |     async clickOnBuyIcon() {
   71 |         await this.buyIconLocator.click();
   72 |         return this.buyIconLocator;
   73 |     }
   74 |     async verifyStoreWidget() {
   75 |         const storeWidget = this.page.locator('.ple-title');
   76 |         await expect(storeWidget).toHaveText('Store');
   77 |         await expect(storeWidget).toBeVisible();
   78 |     }
   79 |     async hardCodedFillPayments() {
   80 |         await this.cardNumberField.fill('4111111111111111');
   81 |         await this.cardExpiryField.fill('12/26');
   82 |         await this.cardCvvField.fill('123');
   83 |         await this.cardNameField.fill('Test User');
   84 |     }
   85 |     async fillPaymentDetails({ cardNumber = null, expiryDate = null, cvv = null, cardHolderName = null } = {}) {
   86 |         if (cardNumber !== null) await this.cardNumberField.fill(cardNumber);
   87 |         if (expiryDate !== null) await this.cardExpiryField.fill(expiryDate);
   88 |         if (cvv !== null) await this.cardCvvField.fill(cvv);
   89 |         if (cardHolderName !== null) await this.cardNameField.fill(cardHolderName);
   90 |     }
   91 |     async clickOnCardPayButton() {
   92 |         await frame.cardPayButtonLocator.click();
   93 |     }
   94 |     async verifyConfirmationMessage() {
>  95 |         await expect(this.confirmationMessageLocator).toBeVisible();
      |                                                       ^ Error: Timed out 5000ms waiting for expect(locator).toBeVisible()
   96 |         await expect(this.confirmationMessageLocator).toHaveText(utils.purchaseMessageText);
   97 |     }
   98 |     async verifyRequiredFieldErrors(expectedMessage) {
   99 |         await expect(this.cardNumberError).toBeVisible();
  100 |         await expect(this.cardNumberError).toHaveText(expectedMessage);
  101 |
  102 |         await expect(this.cardExpiryError).toBeVisible();
  103 |         await expect(this.cardExpiryError).toHaveText(expectedMessage);
  104 |
  105 |         await expect(this.cardCvvError).toBeVisible();
  106 |         await expect(this.cardCvvError).toHaveText(expectedMessage);
  107 |
  108 |         await expect(this.cardNameError).toBeVisible();
  109 |         await expect(this.cardNameError).toHaveText(expectedMessage);
  110 |     }
  111 |     async invalidCardNumberValidation(expectedMessage) {
  112 |         await expect(this.cardNumberError).toBeVisible();
  113 |         await expect(this.cardNumberError).toHaveText(expectedMessage);
  114 |     }
  115 |     async invalidCvvNumberValidation(expectedMessage) {
  116 |         await expect(this.cardCvvError).toBeVisible();
  117 |         await expect(this.cardCvvError).toHaveText(expectedMessage);
  118 |     }
  119 |     async invalidExpiryDateValidation(expectedMessage) {
  120 |         await expect(this.cardExpiryError).toBeVisible();
  121 |         await expect(this.cardExpiryError).toHaveText(expectedMessage);
  122 |     }
  123 |     async clickOnStoreInGame() {
  124 |         await this.inGameStore.click();
  125 |     }
  126 | }
```